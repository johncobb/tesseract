# TSV to Json API

<div id='toc'>

## Table of Contents
  [Table of Contents](#toc)
  [Prerequisites](#pre)
  [Installing Pip](#pip)
  [Virtual Environment](#venv)
  [Installing Requirements](#req)
  [Usage](#use)
  [Endpoints](#end)
  [AWS S3](#s3)
  [Prepping for Zappa](#prepzap)
  [Setting up Zappa](#setupzap)
  [Deploying Zappa](#deployzap)
  [AWS API Gateway](#apigate)
  [Examples](#ex)

<div id='pre'>

## Prerequisites

- Install a [python 3.7](https://www.python.org/downloads/)
- Install [pip](#pip)
- Install a [Virtual Environment](#venv)
- Install the [requirements](#req)

<div id='pip'>

## Installing Pip

`curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py`

`python get-pip.py --user`

<div id='venv'>

## Install virtualenv  

`pip install --user virtualenv`

- Create a folder in tesseract/web/back to house the virtual environment (env). Also, specify this project is using python3.7

`virtualenv -p python3 env`

- Activate environment  

`. env/bin/activate`

<div id='req'>

`pip install -r requirements.txt`

To stop the virtual session  

`deactivate`

<div id='use'>

## Usage

- Navigate to tesseract/web/back
- Activate the [virtual environment](#venv)
```console
python3.7 server.py
```

<div id='end'>

## Endpoints

api/upload

<div id='s3'>

## AWS S3

- Set up awscli pip package and follow the directions from the below command
```console
aws configure
```

<div id='prepzap'>

### Prepping for zappa
- See [Virtual Environment](#venv) to set up the virtual environment
- The recommended name for amazon s3 and the virtual environment set up is env as I found that to be most successful
- Once the virtual environment was activated run the below command
- Navigate to the scripts directory
```console
cd scripts
```

<div id='setupzap'>

### Zappa set up
```console
zappa init
```
- When it gets to what's your app's function OR django settings enter in server.APP
- Make sure that zappa's aws region is set to an aws region (IE us-east-1 and NOT N. Virgiana)

- If zappa recognizes the project as django you'll need to go to the zappa_settings.json file and change a few things
- To change the it to a flask app change the django_settings to app_function
- Make sure that app_function is set to server.APP

<div id='deployzap'>

### Zappa Deploy

- Once all is cleared and good to go run the below command
```console
zappa deploy dev
```

- My stage name is dev so I used dev instead of something else
- To check your stage name go to zappa_settings.json and look at the option you want to deploy
- Check what's on the outside of what's connecting the settings you want to deploy to the outter layer

<div id='apigate'>

### AWS API Gateway

- To get your route go to AWS API Gateway
- Select the one that was generated by zappa
- Most likely will be scripts-(stage name)
- Go to stages
- Click your stage name
- Look at the Invoke URL

<div id='ex'>

## Examples

### Python Example
Refer to test.py

### Curl
```console
curl http://0.0.0.0:3010/api/upload -F 'file=@path/to/file'
```